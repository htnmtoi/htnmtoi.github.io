<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LLVM: llvm::SectionMemoryManager Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">mainline</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespacellvm.html">llvm</a>      </li>
      <li class="navelem"><a class="el" href="classllvm_1_1SectionMemoryManager.html">SectionMemoryManager</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">llvm::SectionMemoryManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="llvm::SectionMemoryManager" --><!-- doxytag: inherits="llvm::RTDyldMemoryManager" -->
<p>This is a simple memory manager which implements the methods called by the <a class="el" href="classllvm_1_1RuntimeDyld.html">RuntimeDyld</a> class to allocate memory for section-based loading of objects, usually those generated by the <a class="el" href="classllvm_1_1MCJIT.html">MCJIT</a> execution engine.  
 <a href="classllvm_1_1SectionMemoryManager.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SectionMemoryManager_8h_source.html">SectionMemoryManager.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for llvm::SectionMemoryManager:</div>
<div class="dyncontent">
<div class="center"><img src="classllvm_1_1SectionMemoryManager__inherit__graph.png" border="0" usemap="#llvm_1_1SectionMemoryManager_inherit__map" alt="Inheritance graph"/></div>
<map name="llvm_1_1SectionMemoryManager_inherit__map" id="llvm_1_1SectionMemoryManager_inherit__map">
<area shape="rect" id="node2" href="classllvm_1_1RTDyldMemoryManager.html" title="llvm::RTDyldMemoryManager" alt="" coords="151,160,356,189"/><area shape="rect" id="node4" href="classllvm_1_1MCJITMemoryManager.html" title="llvm::MCJITMemoryManager" alt="" coords="32,83,229,112"/><area shape="rect" id="node6" href="classllvm_1_1RuntimeDyld_1_1MemoryManager.html" title="Memory Management." alt="" coords="5,5,256,35"/><area shape="rect" id="node8" href="classllvm_1_1RuntimeDyld_1_1SymbolResolver.html" title="Symbol resolution." alt="" coords="253,83,499,112"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for llvm::SectionMemoryManager:</div>
<div class="dyncontent">
<div class="center"><img src="classllvm_1_1SectionMemoryManager__coll__graph.png" border="0" usemap="#llvm_1_1SectionMemoryManager_coll__map" alt="Collaboration graph"/></div>
<map name="llvm_1_1SectionMemoryManager_coll__map" id="llvm_1_1SectionMemoryManager_coll__map">
<area shape="rect" id="node2" href="classllvm_1_1RTDyldMemoryManager.html" title="llvm::RTDyldMemoryManager" alt="" coords="151,160,356,189"/><area shape="rect" id="node4" href="classllvm_1_1MCJITMemoryManager.html" title="llvm::MCJITMemoryManager" alt="" coords="32,83,229,112"/><area shape="rect" id="node6" href="classllvm_1_1RuntimeDyld_1_1MemoryManager.html" title="Memory Management." alt="" coords="5,5,256,35"/><area shape="rect" id="node8" href="classllvm_1_1RuntimeDyld_1_1SymbolResolver.html" title="Symbol resolution." alt="" coords="253,83,499,112"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classllvm_1_1SectionMemoryManager-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>MemoryGroup</b></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllvm_1_1SectionMemoryManager.html#a3538a938a24bdb6853fcbbdad029c506">SectionMemoryManager</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllvm_1_1SectionMemoryManager.html#a709a05abb7e82c5c8fefcc7ee16a3252">~SectionMemoryManager</a> () override</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllvm_1_1SectionMemoryManager.html#acfcf22eac937cf698005e9cc378cad73">allocateCodeSection</a> (uintptr_t Size, <a class="el" href="classunsigned.html">unsigned</a> Alignment, <a class="el" href="classunsigned.html">unsigned</a> SectionID, <a class="el" href="classllvm_1_1StringRef.html">StringRef</a> SectionName) override</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a memory block of (at least) the given size suitable for executable code.  <a href="#acfcf22eac937cf698005e9cc378cad73"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllvm_1_1SectionMemoryManager.html#ac4eeaddc4bbbe555cb2abc159b96492c">allocateDataSection</a> (uintptr_t Size, <a class="el" href="classunsigned.html">unsigned</a> Alignment, <a class="el" href="classunsigned.html">unsigned</a> SectionID, <a class="el" href="classllvm_1_1StringRef.html">StringRef</a> SectionName, <a class="el" href="classbool.html">bool</a> isReadOnly) override</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a memory block of (at least) the given size suitable for executable code.  <a href="#ac4eeaddc4bbbe555cb2abc159b96492c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllvm_1_1SectionMemoryManager.html#af06d61d7c637095c5b7270b34224c5dd">finalizeMemory</a> (std::string *ErrMsg=nullptr) override</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Update section-specific memory permissions and other attributes.  <a href="#af06d61d7c637095c5b7270b34224c5dd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllvm_1_1SectionMemoryManager.html#a64835973f93c4f018aa377870e15ee97">invalidateInstructionCache</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Invalidate instruction cache for code sections.  <a href="#a64835973f93c4f018aa377870e15ee97"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This is a simple memory manager which implements the methods called by the <a class="el" href="classllvm_1_1RuntimeDyld.html">RuntimeDyld</a> class to allocate memory for section-based loading of objects, usually those generated by the <a class="el" href="classllvm_1_1MCJIT.html">MCJIT</a> execution engine. </p>
<p>This memory manager allocates all section memory as read-write. The <a class="el" href="classllvm_1_1RuntimeDyld.html">RuntimeDyld</a> will copy JITed section memory into these allocated blocks and perform any necessary linking and relocations.</p>
<p>Any client using this memory manager MUST ensure that section-specific page permissions have been applied before attempting to execute functions in the JITed object. Permissions can be applied either by calling <a class="el" href="classllvm_1_1MCJIT.html#a46de6cc1d24bff3fd2ae2006c8b35456" title="finalizeObject - ensure the module is fully processed and is usable.">MCJIT::finalizeObject</a> or by calling <a class="el" href="classllvm_1_1SectionMemoryManager.html#af06d61d7c637095c5b7270b34224c5dd" title="Update section-specific memory permissions and other attributes.">SectionMemoryManager::finalizeMemory</a> directly. Clients of <a class="el" href="classllvm_1_1MCJIT.html">MCJIT</a> should call <a class="el" href="classllvm_1_1MCJIT.html#a46de6cc1d24bff3fd2ae2006c8b35456" title="finalizeObject - ensure the module is fully processed and is usable.">MCJIT::finalizeObject</a>. </p>

<p>Definition at line <a class="el" href="SectionMemoryManager_8h_source.html#l00037">37</a> of file <a class="el" href="SectionMemoryManager_8h_source.html">SectionMemoryManager.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a3538a938a24bdb6853fcbbdad029c506"></a><!-- doxytag: member="llvm::SectionMemoryManager::SectionMemoryManager" ref="a3538a938a24bdb6853fcbbdad029c506" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">llvm::SectionMemoryManager::SectionMemoryManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SectionMemoryManager_8h_source.html#l00042">42</a> of file <a class="el" href="SectionMemoryManager_8h_source.html">SectionMemoryManager.h</a>.</p>

</div>
</div>
<a class="anchor" id="a709a05abb7e82c5c8fefcc7ee16a3252"></a><!-- doxytag: member="llvm::SectionMemoryManager::~SectionMemoryManager" ref="a709a05abb7e82c5c8fefcc7ee16a3252" args="() override" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classllvm_1_1SectionMemoryManager.html#a709a05abb7e82c5c8fefcc7ee16a3252">llvm::SectionMemoryManager::~SectionMemoryManager</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [override]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SectionMemoryManager_8cpp_source.html#l00168">168</a> of file <a class="el" href="SectionMemoryManager_8cpp_source.html">SectionMemoryManager.cpp</a>.</p>

<p>References <a class="el" href="classllvm_1_1sys_1_1Memory.html#a042d24349a4b6a5ce475309cce529ae0">llvm::sys::Memory::releaseMappedMemory()</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="acfcf22eac937cf698005e9cc378cad73"></a><!-- doxytag: member="llvm::SectionMemoryManager::allocateCodeSection" ref="acfcf22eac937cf698005e9cc378cad73" args="(uintptr_t Size, unsigned Alignment, unsigned SectionID, StringRef SectionName) override" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t * <a class="el" href="classllvm_1_1SectionMemoryManager.html#acfcf22eac937cf698005e9cc378cad73">llvm::SectionMemoryManager::allocateCodeSection</a> </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>Size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a>&#160;</td>
          <td class="paramname"><em>Alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a>&#160;</td>
          <td class="paramname"><em>SectionID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1StringRef.html">StringRef</a>&#160;</td>
          <td class="paramname"><em>SectionName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [override, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocates a memory block of (at least) the given size suitable for executable code. </p>
<p>The value of <code>Alignment</code> must be a power of two. If <code>Alignment</code> is zero a default alignment of 16 will be used. </p>

<p>Implements <a class="el" href="classllvm_1_1RuntimeDyld_1_1MemoryManager.html#aafb1f4197233eb8c711678479f5382d8">llvm::RuntimeDyld::MemoryManager</a>.</p>

<p>Definition at line <a class="el" href="SectionMemoryManager_8cpp_source.html#l00031">31</a> of file <a class="el" href="SectionMemoryManager_8cpp_source.html">SectionMemoryManager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac4eeaddc4bbbe555cb2abc159b96492c"></a><!-- doxytag: member="llvm::SectionMemoryManager::allocateDataSection" ref="ac4eeaddc4bbbe555cb2abc159b96492c" args="(uintptr_t Size, unsigned Alignment, unsigned SectionID, StringRef SectionName, bool isReadOnly) override" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t * <a class="el" href="classllvm_1_1SectionMemoryManager.html#ac4eeaddc4bbbe555cb2abc159b96492c">llvm::SectionMemoryManager::allocateDataSection</a> </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>Size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a>&#160;</td>
          <td class="paramname"><em>Alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a>&#160;</td>
          <td class="paramname"><em>SectionID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1StringRef.html">StringRef</a>&#160;</td>
          <td class="paramname"><em>SectionName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>isReadOnly</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [override, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocates a memory block of (at least) the given size suitable for executable code. </p>
<p>The value of <code>Alignment</code> must be a power of two. If <code>Alignment</code> is zero a default alignment of 16 will be used. </p>

<p>Implements <a class="el" href="classllvm_1_1RuntimeDyld_1_1MemoryManager.html#a2d8d8e7063216d9520534acaf8c5cbd9">llvm::RuntimeDyld::MemoryManager</a>.</p>

<p>Definition at line <a class="el" href="SectionMemoryManager_8cpp_source.html#l00021">21</a> of file <a class="el" href="SectionMemoryManager_8cpp_source.html">SectionMemoryManager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="af06d61d7c637095c5b7270b34224c5dd"></a><!-- doxytag: member="llvm::SectionMemoryManager::finalizeMemory" ref="af06d61d7c637095c5b7270b34224c5dd" args="(std::string *ErrMsg=nullptr) override" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classllvm_1_1SectionMemoryManager.html#af06d61d7c637095c5b7270b34224c5dd">llvm::SectionMemoryManager::finalizeMemory</a> </td>
          <td>(</td>
          <td class="paramtype">std::string *&#160;</td>
          <td class="paramname"><em>ErrMsg</em> = <code>nullptr</code></td><td>)</td>
          <td><code> [override, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update section-specific memory permissions and other attributes. </p>
<p>This method is called when object loading is complete and section page permissions can be applied. It is up to the memory manager implementation to decide whether or not to act on this method. The memory manager will typically allocate all sections as read-write and then apply specific permissions when this method is called. Code sections cannot be executed until this function has been called. In addition, any cache coherency operations needed to reliably use the memory are also performed.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if an error occurred, false otherwise. </dd></dl>

<p>Implements <a class="el" href="classllvm_1_1RuntimeDyld_1_1MemoryManager.html#abd33e61ef93ebdd7c7b40c62f43f71b3">llvm::RuntimeDyld::MemoryManager</a>.</p>

<p>Definition at line <a class="el" href="SectionMemoryManager_8cpp_source.html#l00105">105</a> of file <a class="el" href="SectionMemoryManager_8cpp_source.html">SectionMemoryManager.cpp</a>.</p>

<p>References <a class="el" href="SectionMemoryManager_8cpp_source.html#l00162">invalidateInstructionCache()</a>, <a class="el" href="Memory_8h_source.html#l00050">llvm::sys::Memory::MF_EXEC</a>, and <a class="el" href="Memory_8h_source.html#l00048">llvm::sys::Memory::MF_READ</a>.</p>

</div>
</div>
<a class="anchor" id="a64835973f93c4f018aa377870e15ee97"></a><!-- doxytag: member="llvm::SectionMemoryManager::invalidateInstructionCache" ref="a64835973f93c4f018aa377870e15ee97" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classllvm_1_1SectionMemoryManager.html#a64835973f93c4f018aa377870e15ee97">llvm::SectionMemoryManager::invalidateInstructionCache</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Invalidate instruction cache for code sections. </p>
<p>Some platforms with separate data cache and instruction cache require explicit cache flush, otherwise JIT code manipulations (like resolved relocations) will get to the data cache but not to the instruction cache.</p>
<p>This method is called from finalizeMemory. </p>

<p>Definition at line <a class="el" href="SectionMemoryManager_8cpp_source.html#l00162">162</a> of file <a class="el" href="SectionMemoryManager_8cpp_source.html">SectionMemoryManager.cpp</a>.</p>

<p>References <a class="el" href="classllvm_1_1sys_1_1Memory.html#a5cfd4d2a8227a3f9ca0667f42f05f20b">llvm::sys::Memory::InvalidateInstructionCache()</a>.</p>

<p>Referenced by <a class="el" href="SectionMemoryManager_8cpp_source.html#l00105">finalizeMemory()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="SectionMemoryManager_8h_source.html">SectionMemoryManager.h</a></li>
<li><a class="el" href="SectionMemoryManager_8cpp_source.html">SectionMemoryManager.cpp</a></li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 2 2015 04:34:58 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
